# ä¸‰é“è¢«é—®çƒ‚äº†çš„å¤šçº¿ç¨‹é¢è¯•é¢˜

## é¢è¯•é¢˜ä¸€ï¼šåˆ©ç”¨å¤šçº¿ç¨‹æŠ€æœ¯å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹

### ä»€ä¹ˆæ˜¯ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å‹

> é€šä¿—çš„è®²ï¼Œå°±æ˜¯ç”Ÿäº§è€…åœ¨ä¸æ–­çš„ç”Ÿäº§ï¼Œæ¶ˆè´¹è€…ä¹Ÿåœ¨ä¸æ–­çš„æ¶ˆè´¹ã€‚ç”Ÿäº§è€…ç”Ÿæˆäº†ä¸œè¥¿é€šçŸ¥æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œæ²¡æœ‰ä¸œè¥¿äº†æ¶ˆè´¹è€…åˆ™ç­‰åˆ°ç”Ÿäº§è€…ç”Ÿæˆã€‚ä»è€Œé€šè¿‡ä¸€ä¸ªä¸­é—´å®¹å™¨æˆ–é€šä¿¡æ‰‹æ®µæ¥è§£å†³ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å¼ºè€¦åˆé—®é¢˜ã€‚

è¿™ä¹Ÿå°±å¼•å‡ºä¸€ç§ç®€å•çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…å®ç°æ–¹å¼

#### ä½¿ç”¨é˜»å¡é˜Ÿåˆ—

**ç”Ÿäº§è€…**

```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 14:24
 * @Version 1.0
 */
public class Product extends Thread {
    private LinkedBlockingDeque<String> stringLinkedBlockingDeque;

    Product(LinkedBlockingDeque<String> stringLinkedBlockingDeque) {
        this.stringLinkedBlockingDeque = stringLinkedBlockingDeque;
    }

    @Override
    public void run() {
        for (int i = 0; i < 5; i++) {
            int nextInt = new Random().nextInt(5000);
            try {
                stringLinkedBlockingDeque.put("ç‰©å“" + i);
                System.out.println("ç”Ÿäº§è€…ç”Ÿäº§:" + i);
                sleep(nextInt);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

        }

    }
}
```

**æ¶ˆè´¹è€…**

```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 14:23
 * @Version 1.0
 */
public class Consumer extends Thread {
    private LinkedBlockingDeque<String> stringLinkedBlockingDeque;

    Consumer(LinkedBlockingDeque<String> stringLinkedBlockingDeque) {
        this.stringLinkedBlockingDeque = stringLinkedBlockingDeque;
    }

    @Override
    public void run() {
        for (int i = 0; i < 5; i++) {
            int nextInt = new Random().nextInt(10000);
            try {
                String take = stringLinkedBlockingDeque.take();
                System.out.println(Thread.currentThread()+":æ¶ˆè´¹è€…æ¶ˆè´¹ï¼š"+take);
                sleep(nextInt);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

        }

    }
}
```

æµ‹è¯•ç±»

```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 14:30
 * @Version 1.0
 */
public class MainTest {
    public static void main(String[] args) {
        LinkedBlockingDeque<String> strings = new LinkedBlockingDeque<String>(4);
        new Product(strings).start();
        new Consumer(strings).start();
        new Consumer(strings).start();
        new Consumer(strings).start();
    }
}
```

æµ‹è¯•ç»“æœ
![](https://user-gold-cdn.xitu.io/2020/7/11/1733c999e2feca15?w=932&h=519&f=png&s=57840)

è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é€šè¿‡é˜»å¡é˜Ÿåˆ—å®ç°äº†ä¸€ä¸ªå¤šçº¿ç¨‹çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œåªè¦é˜Ÿåˆ—é‡Œé¢æœ‰ç‰©å“ï¼Œæ¶ˆè´¹è€…å°±è°ƒç”¨é˜»å¡çš„takeæ–¹æ³•è¿›è¡Œæ¶ˆè´¹ï¼Œå¦‚æœæ²¡æœ‰ç‰©å“åˆ™è¿›è¡Œç­‰å¾…ã€‚ä¸‰ä¸ªæ¶ˆè´¹è€…äº’ä¸å½±å“ä¹Ÿä¸å­˜åœ¨é‡å¤æ¶ˆè´¹çš„æƒ…å†µã€‚

####  ä½¿ç”¨çº¿ç¨‹åä½œ

æƒ³è¦ä¸¾ä¸€åä¸‰çš„é€šè¿‡å¤šçº¿ç¨‹åä½œæ¥å®ç°ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹ï¼Œä½ `å¿…é¡»`å½»åº•å¼„æ¸…é™¤wait()ï¼Œnotify()ï¼ŒnotifyAll()ä¸‹é¢å°±é€šä¿—çš„å‘Šè¯‰å¤§å®¶è¿™ä¸‰è€…æ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ã€‚

- `ä½ å¿…é¡»çŸ¥é“`è¿™ä¸‰è€…éƒ½æ˜¯Objectç±»çš„æ–¹æ³•ï¼Œä¸æ˜¯çº¿ç¨‹ç‹¬è‡ªæŒæœ‰çš„æ–¹æ³•ã€‚
- `ä½ å¿…é¡»çŸ¥é“`wait()çš„ä½œç”¨æ˜¯å°†å½“å‰çº¿ç¨‹ç½®äºé¢„æ‰§è¡Œé˜Ÿåˆ—ï¼Œå¹¶åœ¨wait()æ‰€åœ¨çš„ä»£ç å¤„åœæ­¢ï¼Œç­‰å¾…å”¤é†’é€šçŸ¥ã€‚
- `ä½ å¿…é¡»çŸ¥é“`wait(),notify()`åªèƒ½`åœ¨åŒæ­¥ä»£ç å—æˆ–è€…åŒæ­¥æ–¹æ³•ä¸­æ‰§è¡Œï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
- `ä½ å¿…é¡»çŸ¥é“`wait()æ–¹æ³•è°ƒç”¨åæ‚”é‡Šæ”¾å‡ºé”ï¼Œçº¿ç¨‹ä¸å…¶ä»–çº¿ç¨‹ç«äº‰é‡æ–°è·å–é”ã€‚
- `ä½ å¿…é¡»çŸ¥é“`notify()ï¼Œä¼šé€šçŸ¥é‚£äº›ç­‰å¾…`å½“å‰çº¿ç¨‹å¯¹è±¡é”`çš„çº¿ç¨‹ï¼Œå¹¶ä½¿å®ƒä»¬é‡æ–°è·å–è¯¥çº¿ç¨‹çš„å¯¹è±¡é”ï¼Œå¦‚æœç­‰å¾…çº¿ç¨‹æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œåˆ™æœ‰çº¿ç¨‹è§„åˆ’å™¨éšæœºæŒ‘é€‰å‡ºä¸€ä¸ªå‘ˆwaitçŠ¶æ€çš„çº¿ç¨‹ã€‚
- `ä½ å¿…é¡»çŸ¥é“`notifyAllä¼šå”¤é†’æ‰€æœ‰ç­‰å¾…`å½“å‰çº¿ç¨‹å¯¹è±¡é”`çº¿ç¨‹ï¼Œå…·ä½“å“ªä¸€ä¸ªçº¿ç¨‹å°†ä¼šç¬¬ä¸€ä¸ªå¤„ç†å–å†³äºæ“ä½œç³»ç»Ÿçš„å®ç°ã€‚

ä»£ç å®ç°ï¼š
```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 15:16
 * @Version 1.0
 */
public class Goods {
    private int id;
    private String name;
    public Goods(int id, String name) {
        this.id = id;
        this.name = name;
    }
}

```
ç”Ÿäº§è€…
```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 15:17
 * @Version 1.0
 */
public class Producer implements Runnable {
    private Goods goods;
    private Object lock;
    private Vector<Goods> container;

    Producer(Object lock, Vector<Goods> container) {
        this.lock = lock;
        this.container = container;
    }

    @Override
    public void run() {
        while (true) {
            synchronized (lock) {
                goods = new Goods(1, "å•†å“");
                if (container.size() < 5) {
                    container.add(goods);
                    System.out.println(Thread.currentThread().getName() + "ç”Ÿäº§å•†å“");
                } else {
                    try {
                        lock.wait();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }

        }
    }
}
```

æ¶ˆè´¹è€…
```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 15:17
 * @Version 1.0
 */
public class Consumer implements Runnable {
    private Goods goods;
    private Object lock;
    private Vector<Goods> container;

    Consumer(Object lock, Vector<Goods> container) {
        this.lock = lock;
        this.container = container;
    }

    @Override
    public void run() {
        while (true) {
            try {
                Thread.sleep(2000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            synchronized (lock) {
                if (!container.isEmpty()) {
                    container.remove(0);
                    System.out.println(Thread.currentThread().getName() + "æ¶ˆè´¹å•†å“");
                } else {
                    lock.notifyAll();
                }
            }
        }
    }
}


```
æµ‹è¯•ç±»
```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 15:24
 * @Version 1.0
 */
public class MainTest {
    public static void main(String[] args) {
        Vector<Goods> goods = new Vector<Goods>(5);
        Object lock = new Object();
        Producer producer = new Producer(lock, goods);
        Consumer consumer = new Consumer(lock, goods);
        for (int i = 0; i < 5; i++) {
            Thread threadA = new Thread(producer, "ç”Ÿäº§è€…çº¿ç¨‹" + i);
            threadA.start();
        }
        for (int j = 0; j < 3; j++) {
            Thread threadB = new Thread(consumer, "æ¶ˆè´¹è€…çº¿ç¨‹" + j);
            threadB.start();
        }
    }
}

```
æ‰§è¡Œç»“æœï¼š
![](https://user-gold-cdn.xitu.io/2020/7/11/1733cf0e26e9811d?w=924&h=684&f=png&s=76150)
ä»£ç è§£è¯´ï¼ˆ`ä¸æ¸…æ¥šä¸€å®šè¦çœ‹`ï¼‰ï¼š
-  Object lock = new Object(); è¿™æ ·å†™çš„ç›®çš„æ˜¯è®©ä½ çŸ¥é“synchronizedæ˜¯é€šè¿‡è·å–ä¸€ä¸ª`å¯¹è±¡`ä½œä¸ºé”ï¼Œè€Œä¸æ˜¯æŠŠçº¿ç¨‹å½“ä½œé”ã€‚
-  ç”Ÿäº§è€…è¿›è¡Œç”Ÿäº§ï¼Œç”Ÿäº§æ»¡äº”ä¸ªè¿‡åæŒ‚èµ·å½“å‰çº¿ç¨‹å¹¶é‡Šæ”¾é”(locké”å¯¹è±¡)ï¼Œè®©å…¶ä»–çº¿ç¨‹ï¼ˆåŒ…æ‹¬æ¶ˆè´¹è€…çº¿ç¨‹ï¼‰ç«äº‰ã€‚
-  æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹ï¼Œå½“å®¹å™¨ä¸ºç©ºçš„æ—¶å€™ï¼ˆé€šè¿‡å”¤é†’`ç­‰å¾…locké”å¯¹è±¡`çš„çº¿ç¨‹ï¼‰é€šçŸ¥å…¶ä»–ç”Ÿäº§çº¿ç¨‹æ‰§è¡Œrunæ–¹æ³•ã€‚

## é¢è¯•é¢˜äºŒï¼šåˆ©ç”¨å¤šçº¿ç¨‹äº¤æ›¿æ‰“å°0-100
> è¿™ç§é¢˜ç›®å‘¢å…¶å®ä¹Ÿä¸ç®—ç¨€å¥‡äº†ï¼Œä¸€èˆ¬çš„JavaåŸºç¡€ä¹¦ç±ä¸Šéƒ½æœ‰ä»‹ç»ï¼Œä½†æ˜¯å¯¹äºå¾ˆå¤šåˆå­¦è€…æ¥è¯´ï¼Œå­¦ä¹ Javaå·²ç»å¾ˆå¤´ç–¼äº†ï¼Œåœ¨é‚£ä¸ªé˜¶æ®µæƒ³çœ‹æ‡‚å¤šçº¿ç¨‹çš„çŸ¥è¯†ï¼Œå¿…å®šæ˜¯ä¸€ä»¶è¦å‘½çš„äº‹æƒ…ã€‚

ä»Šå¤©æˆ‘å°±å¸®å¤§å®¶å¥½å¥½æ‹ä¸€æ‹...
### å®ç°ä¸€ï¼šä½¿ç”¨wait/notify
ç›´æ¥ä¸Šä»£ç 
```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.ReentrantLock;

/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/2/27 15:06
 * PACKAGE_NAME
 * @Description:
 */
public class PrintThread {
    public static int num = 1;
    public static void main(String[] args) {
        ExecutorService executorService = Executors.newFixedThreadPool(2);
        Thread1 thread1 = new Thread1();
        thread1.setName("çº¿ç¨‹ä¸€");
        Thread2 thread2 = new Thread2();
        thread2.setName("çº¿ç¨‹äºŒ");
        executorService.submit(thread1);
        executorService.submit(thread2);
        executorService.shutdown();
    }

    static class Thread1 extends Thread {
        @Override
        public void run() {
            print();
        }
    }

    static class Thread2 extends Thread {
        @Override
        public void run() {
            print();

        }
    }

    static void print() {
        synchronized (PrintThread.class) {
            while (true) {
                try {
                    PrintThread.class.notify();
                    if(num<=100){
                        if (Thread.currentThread().getName().equals("çº¿ç¨‹ä¸€")) {
                            if(num%2==0){
                                System.out.println(Thread.currentThread().getName() + "->" + num++);
                            }
                        }else{
                            System.out.println(Thread.currentThread().getName() + "->" + num++);
                        }
                    }
                    PrintThread.class.wait();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }

    }
}
```
**é—®é¢˜:**

1. synchronized (PrintThread.class)æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

 ç­”ï¼šPrintThread.classå½“å‰ç±»ä½œä¸ºä¸€ä¸ªé”å¯¹è±¡ï¼ˆç±»é”ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹æƒ³è¿›å…¥synchronizedæ–¹æ³•å¿…é¡»è·å–å½“å‰é”å¯¹è±¡ã€‚å…¶æ¬¡ï¼Œæ–¹ä¾¿ç†è§£waitå’Œnotifyå…·ä½“æ“ä½œçš„æ˜¯é”å¯¹è±¡ã€‚

2. ä¸ºä»€ä¹ˆè¦å…ˆnotify()ï¼Ÿ

ç­”:å¦‚æœä¸€ä¸ªçº¿ç¨‹æŠ¢å äº†èµ„æºç„¶åç«‹é©¬wait()åˆæŒ‚èµ·è¿™å°±é™·å…¥äº†æ­»å¾ªç¯ã€‚å…ˆä½¿ç”¨notify()æ˜¯ä¸ºäº†ä¿è¯ä¸¤ä¸ªçº¿ç¨‹å¯ä»¥ç›¸äº’å”¤é†’ã€‚

3. ä¸ºä»€ä¹ˆä¸ç”¨notifyAll()?

ç­”ï¼šå°±å½“å‰åœºæ™¯notify()å°±è¶³å¤Ÿäº†ï¼Œä½ å–œæ¬¢ä¹Ÿå¯ä»¥ä½¿ç”¨notifyAll()ã€‚
### å®ç°äºŒï¼šä½¿ç”¨Locké”
ä¸Šä»£ç 
```java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.locks.Condition;
import java.util.concurrent.locks.ReentrantLock;

/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 15:06
 * PACKAGE_NAME
 * @Description:
 */
public class PrintThread {
    public static int num = 1;
    public static ReentrantLock reentrantLock = new ReentrantLock();
    public static Condition condition = reentrantLock.newCondition();
    public static void main(String[] args) {
        ExecutorService executorService = Executors.newFixedThreadPool(2);
        Thread1 thread1 = new Thread1();
        thread1.setName("çº¿ç¨‹ä¸€");
        Thread2 thread2 = new Thread2();
        thread2.setName("çº¿ç¨‹äºŒ");
        executorService.submit(thread1);
        executorService.submit(thread2);
        executorService.shutdown();
    }

    static class Thread1 extends Thread {
        @Override
        public void run() {
            print();
        }
    }

    static class Thread2 extends Thread {
        @Override
        public void run() {
            print();

        }
    }

    static void print() {
     reentrantLock.lock();
        synchronized (PrintThread.class) {
            while (true) {
                try {
                    condition.signal();
                    if(num<=100){
                        if (Thread.currentThread().getName().equals("çº¿ç¨‹ä¸€")) {
                            if(num%2==0){
                                System.out.println(Thread.currentThread().getName() + "->" + num++);
                            }
                        }else{
                            System.out.println(Thread.currentThread().getName() + "->" + num++);
                        }
                    }
                    condition.await();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
           reentrantLock.unlock();
        }
    }
}

```

è¯¥å®ç°å¤§åŒå°å¼‚ï¼Œç›¸æ¯”äºä¸Šé¢çš„æ›´å¥½ç†è§£ã€‚reentrantLock åŠå¯¹ä»£ç å—è¿›è¡Œæ·é”è§£é”æ“ä½œã€‚condition åŠæ“ä½œæ¡ä»¶æä¾›äº†ç±»ä¼¼Objectçš„ç›‘è§†å™¨æ–¹æ³•,ä¸Locké…åˆå¯ä»¥å®ç°ç­‰å¾…/é€šçŸ¥æ¨¡å¼ã€‚

## é¢è¯•é¢˜ä¸‰ï¼šåˆ©ç”¨å¤šçº¿ç¨‹ä¸€ä¸ªåšåŠ æ³•ä¸€ä¸ªåšé™¤æ³•ï¼Œæœ€åæ±‚å’Œè®¡ç®—
çœ‹åˆ°è¿™ä¸ªé¢˜ç›®ä½ å¯èƒ½æƒ³çš„æœ€å¤šçš„æ˜¯æˆ‘å¦‚ä½•è·å–çº¿ç¨‹è®¡ç®—åå¾—å€¼ï¼Ÿ

### å¸¸è§„æ“ä½œ
**çœ‹ä»£ç **
```java
/**
 * @Auther: çˆ±å” å—‘çš„é˜¿ç£Š
 * @Company: Javaç¼–ç¨‹ä¹‹é“
 * @Date: 2020/7/11 16:07
 * @Description:
 */
public class ThreadsCount {
    public static void main(String[] args) {
        int a = 1;
        int b = 2;
        int c = 98;
        int d = 1;
        int sum = 0;
        ThreadA threadA = new ThreadA(a, b);
        ThreadB threadB = new ThreadB(c, d);
        ExecutorService executorService = Executors.newFixedThreadPool(2);
        Future<Integer> first = executorService.submit(threadA);
        Future<Integer> two = executorService.submit(threadB);
        try {
            Integer aa = first.get();
            Integer bb = two.get();
            sum = aa + bb;
            System.out.println(sum);
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        } finally {
            executorService.shutdown();
        }
    }
}


class ThreadA implements Callable<Integer> {
    int a = 0;
    int b = 0;

    public ThreadA(int a, int b) {
        this.a = a;
        this.b = b;
    }

    @Override
    public Integer call() throws Exception {
        return a * b;
    }

}

class ThreadB implements Callable<Integer> {
    // å¤„ç†d=0çš„å¼‚å¸¸
    int c = 0;
    int d = 0;

    public ThreadB(int c, int d) {
        this.c = c;
        this.d = d;
    }

    @Override
    public Integer call() throws Exception {
        return c / d;
    }

}
```
è¿™æ˜¯ä½¿ç”¨çº¿ç¨‹æ± æ¥å®ç°çš„ï¼Œè°ƒç”¨çº¿ç¨‹æ± submitæ–¹æ³•å¯ä»¥è·å–ä¸€ä¸ªFutureï¼Œè°ƒç”¨Futureçš„getæ–¹æ³•å¯ä»¥é˜»å¡è·å–çº¿ç¨‹è¿”å›å€¼ã€‚é™¤æ­¤ä¹‹å¤–ä»¥å¯ä»¥å®ç°Callableæ¥å£è·å–è¿”å›å€¼ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è‡ªå·±è¯•ä¸€è¯•ï¼Œæ¯”è¾ƒç®€å•å°±ä¸è´´ä»£ç ã€‚

`ä½†æ˜¯ï¼ï¼ï¼`ä½ ä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼Œæˆ‘å…¶å®è¦è¯´çš„æ˜¯å¦å¤–ä¸€ç§å®ç°æ–¹å¼ï¼Œæ›´åŠ çš„ğŸ‚çš®Plusï¼ä½ ç»å¯¹æ²¡ç”¨è¿‡ï¼

### éªšæ“ä½œ

ä½¿ç”¨**CompletionService**å®ç°ã€‚
>å®ƒå°†Executorå’ŒBlockingQueueçš„åŠŸèƒ½èåˆåœ¨ä¸€èµ·ï¼Œä½ å¯ä»¥å°†Callableä»»åŠ¡æäº¤ç»™ä»–æ¥å®Œæˆï¼Œç„¶åä½¿ç”¨ç±»ä¼¼é˜Ÿåˆ—çš„takeå’Œpollæ–¹æ³•æ¥è·å–å·²ç»å®Œæˆçš„ä»»åŠ¡ç»“æœã€‚å…¶ç»“æœä¼šè¢«å°è£…æˆä¸€ä¸ªFutureç±»ã€‚

**ä¸Šä»£ç **
```java
import java.util.concurrent.*;

/**
 * @Auther: Xianglei
 * @Company: xxx
 * @Date: 2020/3/15 18:07
 * PACKAGE_NAME
 * @Description:
 */
public class ThreadsCount {
    public static void main(String[] args) {
        int a = 1;
        int b = 2;
        int c = 98;
        int d = 1;
        int sum = 0;
        ThreadA threadA = new ThreadA(a, b);
        ThreadB threadB = new ThreadB(c, d);
        ExecutorService executorService = Executors.newFixedThreadPool(2);
        ExecutorCompletionService<Integer> integerExecutorCompletionService = new ExecutorCompletionService<Integer>(executorService);
        integerExecutorCompletionService.submit(threadA);
        integerExecutorCompletionService.submit(threadB);
        try {
            for (int i = 1; i <=2; i++) {
                Future<Integer> take = integerExecutorCompletionService.take();
                sum = sum + take.get();
                System.out.println("ç¬¬"+i+"æ¬¡è®¡ç®—ï¼š"+sum);
            }

        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (ExecutionException e) {
            e.printStackTrace();
        }
    }
}


class ThreadA implements Callable<Integer> {
    int a = 0;
    int b = 0;

    public ThreadA(int a, int b) {
        this.a = a;
        this.b = b;
    }

    @Override
    public Integer call() throws Exception {
        return a * b;
    }

}

class ThreadB implements Callable<Integer> {
    // å¤„ç†d=0çš„å¼‚å¸¸
    int c = 0;
    int d = 0;

    public ThreadB(int c, int d) {
        this.c = c;
        this.d = d;
    }

    @Override
    public Integer call() throws Exception {
        return c / d;
    }

}

```
æµ‹è¯•ç»“æœ
![](https://user-gold-cdn.xitu.io/2020/7/11/1733d12e176e59d6?w=1920&h=537&f=png&s=116184)
è¯´å¥é¢˜å¤–è¯ï¼šè¿™ç§å®ç°æ–¹å¼æ¯”è¾ƒé€‚åˆäºå‰ç«¯éœ€è¦è¿›è¡Œ`é¡µé¢æ¸²æŸ“`ï¼Œè€Œæ¸²æŸ“çš„æ•°æ®æ¥è‡³äºåæ¥è¿”å›ï¼Œè¿™æ ·åšå¯ä»¥å®ç°åœ¨çº¿ç¨‹æ± ä¸­`å¹¶è¡Œå¤„ç†`ï¼Œæœ€åå°†è·å–åˆ°çš„ç»“æœ`ç«‹åˆ»è¿”å›ï¼ˆæ˜¾ç¤ºï¼‰`å‡ºæ¥ï¼Œå¯ä»¥æ˜¯å‰ç«¯ç”¨æˆ·è·å¾—ä¸€ä¸ªæ›´åŠ åŠ¨æ€å’Œæ›´é«˜å“åº”æ€§çš„ç•Œé¢ã€‚

----

è¿˜æœ‰æ›´å¤šçº¿ç¨‹æ± çš„éªšæ“ä½œï¼Œæˆ‘åé¢åœ¨åˆ†æçº¿ç¨‹æ± è¿™ä¸€å—çš„æ—¶å€™å†è·Ÿå¤§å®¶è¯¦ç»†å” ã€‚ä»Šå¤©æš‚æ—¶å°±èŠè¿™ä¹ˆå¤šäº†ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘åœ¨é¢è¯•`ç¾å›¢ã€ç¥ç­–`é‡åˆ°çš„è€ƒé¢˜ã€‚å¸Œæœ›å¤§å®¶å¥½å¥½ç†è§£ä¸€ä¸‹ï¼Œæœ‰ç–‘é—®æ¬¢è¿å¤§å®¶åé¦ˆäº¤æµå“¦ï¼